(this["webpackJsonpreact-client"]=this["webpackJsonpreact-client"]||[]).push([[0],{42:function(e,n,t){},44:function(e,n,t){},69:function(e,n){},71:function(e,n){},80:function(e,n,t){"use strict";t.r(n);var r=t(5),a=t(8),c=t.n(a),o=t(35),i=t.n(o),s=(t(42),t(2)),u=t.n(s),l=t(36),f=t(7),p=t(9),d=(t(44),t(20)),g=t(13),b=(t(81),t(24)),h=t.n(b);var m,j="domRoom",v={apiKey:"AIzaSyBfoy7wT3avNhSSQePK4V09cyS-h33cbJ0",authDomain:"anticardgamecardgameclub.firebaseapp.com",projectId:"anticardgamecardgameclub",storageBucket:"anticardgamecardgameclub.appspot.com",messagingSenderId:"493065249415",appId:"1:493065249415:web:f5849d1ed56dab0e1c8e22",measurementId:"G-2H0YRN530Y"},O=[{urls:"stun:stun.services.mozilla.com"},{urls:"stun:stun.l.google.com:19302"},{urls:"turn:numb.viagenie.ca",credential:"eXf5uqiGDie3QHU",username:"fujizhang2525@gmail.com"}],x={},w="";function y(){return g.a.apps.length?g.a.app():g.a.initializeApp(v),""==w&&(w=function(){var e=46656*Math.random()|0,n=46656*Math.random()|0;return(e=("000"+e.toString(36)).slice(-3))+("000"+n.toString(36)).slice(-3)}()),w}function S(e){return k.apply(this,arguments)}function k(){return(k=Object(f.a)(u.a.mark((function e(n){var t,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.a.firestore(),r=t.collection(j).doc(),a=Object(d.a)({},w,{name:"bruh",signal:{}}),e.next=5,r.set(a);case 5:return m=r.id,console.log("New room created with SDP offer. Room ID: ".concat(r.id,"  ")),r.onSnapshot(function(){var e=Object(f.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.data(),!t.exists){e.next=6;break}if("Server"!=(t.metadata.hasPendingWrites?"Local":"Server")){e.next=6;break}return e.next=6,N(a,r,n);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),e.abrupt("return",r.id);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,n){return C.apply(this,arguments)}function C(){return(C=Object(f.a)(u.a.mark((function e(n,t){var r,a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=g.a.firestore(),e.next=3,r.collection(j).doc(n);case 3:if(a=e.sent,c=Object(d.a)({},w,{name:"bruh",signal:{}}),null==a){e.next=13;break}return e.next=8,a.set(c,{merge:!0});case 8:return console.log("Joined Room ".concat(a.id)),e.next=11,a.get().then(function(){var e=Object(f.a)(u.a.mark((function e(n){var t,r,c,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=n.data(),r=function(){var e=Object(p.a)(o[c],2),n=e[0],t=e[1];if(n!==w){x[n]={Peer:new h.a({initiator:!0,config:{iceServers:O}}),Connected:!1},console.log("add peer 1"),console.log(x[n]);var r=x[n].Peer;r.on("error",(function(e){console.log(e)})),r.on("signal",(function(e){w in t.signal||(console.log("sent"),t.signal[w]=JSON.stringify(e),a.set(Object(d.a)({},n,t),{merge:!0}))}))}},c=0,o=Object.entries(t);c<o.length;c++)r();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 11:return a.onSnapshot(function(){var e=Object(f.a)(u.a.mark((function e(n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.data(),!n.exists){e.next=6;break}if("Server"!=(n.metadata.hasPendingWrites?"Local":"Server")){e.next=6;break}return e.next=6,N(r,a,t);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,n,t){return I.apply(this,arguments)}function I(){return(I=Object(f.a)(u.a.mark((function e(n,t,r){var a,c,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w in n&&0!==Object.entries(n[w].signal).length)for(a=function(){var e=Object(p.a)(o[c],2),a=e[0];e[1];if(a!=w){if(!(a in x)){console.log(x[a]),x[a]={Peer:new h.a({initiator:!1,config:{iceServers:O}}),Connected:!1},console.log("add peer 2"),console.log(x[a]);var i=x[a].Peer;console.log(x),i.on("error",(function(e){console.log(e)})),i.on("signal",(function(e){w in n[a].signal||(console.log("return signal"),n[a].signal[w]=JSON.stringify(e),t.set(Object(d.a)({},a,n[a]),{merge:!0}))}))}console.log(JSON.parse(n[w].signal[a]));var s=x[a].Peer;s.signal(JSON.parse(n[w].signal[a])),console.log("connect?"),s.on("connect",(function(){console.log("connect"),s.send("hey im ".concat(w,", how is it going?"))})),s.on("data",(function(e){console.log("got a message from peer1: "+e),r(e)})),s.on("close",(function(){s.destroy()}))}},c=0,o=Object.entries(n[w].signal);c<o.length;c++)a();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){return L.apply(this,arguments)}function L(){return(L=Object(f.a)(u.a.mark((function e(n){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.a.firestore(),r=t.collection(j).doc(n),e.next=4,r.get().then(function(){var e=Object(f.a)(u.a.mark((function e(n){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.exists){e.next=8;break}return delete(t=n.data())[w],e.next=5,r.set(t);case 5:console.log("Left Room ".concat(m)),e.next=9;break;case 8:console.log("No such document!");case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var R=function(){t.e(3).then(t.bind(null,84)).then((function(e){var n=e.add_two_ints,t=e.fib,r=n(10,20),a=t(10);w(r),I(a)}));var e=Object(a.useState)(""),n=Object(p.a)(e,2),c=n[0],o=n[1],i=Object(a.useState)(""),s=Object(p.a)(i,2),d=s[0],g=s[1],b=Object(a.useState)([]),h=Object(p.a)(b,2),m=h[0],j=h[1],v=Object(a.useState)(0),O=Object(p.a)(v,2),x=O[0],w=O[1],k=Object(a.useState)(0),C=Object(p.a)(k,2),N=C[0],I=C[1],L=y();function R(){return(R=Object(f.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(z);case 2:n=e.sent,o("created room ".concat(n)),g(n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(f.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""==d){e.next=5;break}return e.next=3,P(d,z);case 3:n=e.sent,o("joined room: ".concat(n?"success":"fail"));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=Object(f.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""!=d&&(J(d),o(""));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){j([].concat(Object(l.a)(m),[e]))}return Object(a.useEffect)((function(){var e=function(){console.log("ran delete"),J(d)};return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}}),[d]),Object(r.jsxs)("div",{className:"App",children:[Object(r.jsxs)("div",{children:["Sum Results: ",x]}),Object(r.jsxs)("div",{children:["Fib Results: ",N]}),L,Object(r.jsx)("input",{type:"text",placeholder:"room code",name:"name",onChange:function(e){return g(e.target.value)}}),Object(r.jsx)("button",{onClick:function(){return R.apply(this,arguments)},children:"create room"}),Object(r.jsx)("button",{onClick:function(){return D.apply(this,arguments)},children:"join room"}),Object(r.jsx)("button",{onClick:function(){return F.apply(this,arguments)},children:"leave room"}),Object(r.jsxs)("div",{children:["log ",c]}),Object(r.jsx)("div",{children:"messages:"}),m.map((function(e){return Object(r.jsx)("div",{children:e})}))]})},D=function(e){e&&e instanceof Function&&t.e(4).then(t.bind(null,83)).then((function(n){var t=n.getCLS,r=n.getFID,a=n.getFCP,c=n.getLCP,o=n.getTTFB;t(e),r(e),a(e),c(e),o(e)}))};i.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(R,{})}),document.getElementById("root")),D()}},[[80,1,2]]]);
//# sourceMappingURL=main.8564e80b.chunk.js.map